{% extends 'layout.html' %}

{% block title %}Home{% endblock %}

{% block content %}

  {% include 'carousel.html' with context %}

  <hr>

  <div class="showcase-books">
    {% for genre in genres %}
      <div class="genres">
        <h2>{{genre.name}}</h2>
        <hr>
         <div class="books">
               {% for book in genre.books %}
                {% if (parameter=="book" and query.lower() in book.title.lower()) or (parameter == "price" and query >= book.price) or (parameter=="genre") or (not parameter) %}
                    <div class="card" style="width: 14rem;">
                      <img src="https://picsum.photos/1000/1000" class="card-img-top" alt="...">
                      <div class="card-body">
                        <h5 class="card-title"><strong>{{ book.title }}</strong></h5>
                        <p class="card-text"><span class="text-muted">Price :</span>&nbsp;&nbsp;<span style="color:red;">&#8377;{{ book.price }}</span></p>
                        <div class="card-buttons">
                          {% if book.quantity > 0 %}
                            <a href="{{ url_for("add_to_cart", book_id=book.id) }}" method="post" class="btn btn-success">Add to cart</a>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop{{book.id}}">Borrow</button>
                            
                            <!-- Modal -->
                            <div class="modal fade" id="staticBackdrop{{book.id}}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                              <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="staticBackdropLabel">Day to Borrow</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
                                  <div class="modal-body">
                                    Select the number of days you want to borrow the book {{ book.title }}.
                                  </div>
                                  <div class="modal-footer">
                                    <form action="{{ url_for("add_to_request", book_id=book.id) }}" method="post">
                                      <input type="number" class="form-control" name="days_requested" value="14" min="7" max="60">
                                      <button type="submit" class="btn btn-primary" method="post">
                                        Request
                                      </button>
                                    </form>
                                  </div>
                                </div>
                              </div>
                            </div>
                          
                          {% else %}
                            <button class="btn btn-outline-danger" disabled><i class="fa-solid fa-x"></i>  Out of stock</button>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                {% endif %}
               {% endfor %}
         </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}



{% block style %}
<style>

  .carousel-image {
    width: 100%;
    height: 300px;
  }

  .carousel {
    margin: 20px 10px 20px 10px;
  }

  .showcase-books {
    display: flex;
    flex-direction: column;
    margin: 20px;
  }

  .genres {
    margin: 20px 0 20px 0;
  }

  .books {
    display: flex;
    flex-wrap: wrap;
    justify-content: left;
  }

  .card {
    margin: 10px;
  }

  .card-buttons {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
  }
</style>
{% endblock %}

